"use strict";!function(d){function t(){this.$hidebox=d(".sn-register"),this.$usernamebox=d(".sn-login"),this.$spicbox=d(".spic"),this.$bpicbox=d(".bf"),this.$productlist=d(".product-list"),this.$titlebox=d(".titlebox"),this.$pricebox=d(".price-right"),this.tablename=location.search.split("?")[1].split("&")[0].split("=")[1],this.id=location.search.split("?")[1].split("&")[1].split("=")[1],this.init()}t.prototype.init=function(){this.getcookie("username")&&(this.$usernamebox.html(this.getcookie("username").split("; ")[0]),this.$usernamebox.attr("href","#"),this.$hidebox.html("退出"),this.$hidebox.attr("href","#"),this.$hidebox.on("click",function(){return that.$usernamebox.html("请登录"),that.$usernamebox.attr("href","http://10.31.158.21:8088/tianmao/object/src/login.html"),that.$hidebox.html("免费注册"),that.$hidebox.attr("href","http://10.31.158.21:8088/tianmao/object/src/registor.html"),that.removecookie("username"),!1})),this.ajax()},t.prototype.ajax=function(){var f=this;d.ajax({url:"http://10.31.158.21:8088/tianmao/object/php/details.php?table="+this.tablename+"&id="+this.id,dataType:"json"}).done(function(n){var t,i,s,o,e,h,c,l="";if(t='\n                <img src="'+n.url+'"alt="" class="spic-pic">\n                <div class="sf"></div>\n                ',i='\n                <img src="'+n.url+'" class="bpic" alt="">\n                ',s='\n                <div class="title">'+n.title+"</div>\n                ",o='\n                    <em>￥</em><span class="price">'+n.price+"</span>\n                ",n.imgurls){var r=n.imgurls.split(",");d.each(r,function(t,i){l+='\n                        <li><img src="'+i+'" alt=""></li>\n                        '}),f.$productlist.html(l)}function a(){this.$spic=e(".spic"),this.$sf=e(".sf"),this.$bpic=e(".bpic"),this.$bf=e(".bf"),this.$picshowbox=e(".product-list"),this.init()}function p(){if(this.$leftbtn=h("#left"),this.$rightbtn=h("#right"),this.$listbox=h(".product-list"),this.$bpic=h(".bpic"),this.$spic=h(".spic-pic"),this.$listbox.find("li")){var t=this.$listbox.find("li").eq(0);this.liwidth=t.width()+parseInt(t.css("padding-left"))+parseInt(t.css("padding-right"))+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right"))+2,this.num=this.$listbox.find("li").length}this.init()}function u(){this.$addbtn=c(".add-btn"),this.$upbtn=c("#up"),this.$downbtn=c("#down"),this.$getnum=c(".get-num"),this.$titlebox1=c(".titlebox1-success"),this.idarr=[],this.numarr=[],this.tablearr=[],this.timer=null,this.init()}f.$spicbox.html(t),f.$bpicbox.html(i),f.$pricebox.html(o),f.$titlebox.html(s),e=jQuery,a.prototype.init=function(){var s=this;this.$spic.hover(function(){s.mouseover(),e("body").on("mousemove",function(t){var i=t||window.event;s.followmouse(i)})},function(){s.mouseup()})},a.prototype.mouseover=function(){this.$sf.css("visibility","visible"),this.$bf.css("visibility","visible")},a.prototype.mouseup=function(){this.$sf.css("visibility","hidden"),this.$bf.css("visibility","hidden")},a.prototype.followmouse=function(t){this.$sf.css({top:t.pageY-this.$spic.offset().top-this.$sf.height()/2-1,left:t.pageX-this.$spic.offset().left-this.$sf.width()/2-1}),this.$sf.position().top<=0&&this.$sf.css("top","0"),this.$sf.position().top>=this.$spic.height()-this.$sf.height()&&this.$sf.css("top",this.$spic.height()-this.$sf.height()),this.$sf.position().left<=0&&this.$sf.css("left","0"),this.$sf.position().left>=this.$spic.width()-this.$sf.width()&&this.$sf.css("left",this.$spic.width()-this.$sf.width()),this.bpicmove()},a.prototype.bpicmove=function(){var t=-this.$sf.position().left/this.$spic.width(),i=-this.$sf.position().top/this.$spic.height();this.$bpic.css({left:this.$bpic.width()*t,top:this.$bpic.height()*i})},new a,h=jQuery,p.prototype.init=function(){var t=this;this.$listbox.find("li")&&(this.$leftbtn.on("click",function(){t.leftclick()}),this.$rightbtn.on("click",function(){t.rightclick()}),this.$listbox.find("li").on("mouseover",function(){t.mouseover(h(this).index())}))},p.prototype.leftclick=function(){this.$leftbtn.css("color","#000"),this.$rightbtn.css("color","#000"),this.$listbox.position().left==-(this.num-6)*this.liwidth?(this.$leftbtn.css("color","transparent"),this.$listbox.css("left",-(this.num-5)*this.liwidth)):this.$listbox.css("left",this.$listbox.position().left-this.liwidth)},p.prototype.rightclick=function(){this.$rightbtn.css("color","#000"),this.$leftbtn.css("color","#000"),this.$listbox.position().left===-this.liwidth?(this.$rightbtn.css("color","transparent"),this.$listbox.css("left",0)):this.$listbox.css("left",this.$listbox.position().left+this.liwidth)},p.prototype.mouseover=function(t){var i=this.$listbox.find("li").eq(t).find("img").attr("src");this.$listbox.find("li").eq(t).css("border-color","#000").siblings("li").css("border-color","#ccc"),this.$bpic.attr("src",i),this.$spic.attr("src",i)},new p,c=jQuery,u.prototype.init=function(){var t=this;this.$upbtn.on("click",function(){t.clickup()}),this.$downbtn.on("click",function(){t.clickdown()}),this.$getnum.on("blur",function(){t.blur()}),this.$addbtn.on("click",function(){t.addcart()})},u.prototype.clickup=function(){999==+this.$getnum.val()?this.$getnum.val(999):this.$getnum.val(+this.$getnum.val()+1)},u.prototype.clickdown=function(){1==+this.$getnum.val()?this.$getnum.val(1):this.$getnum.val(+this.$getnum.val()-1)},u.prototype.blur=function(){999<=+this.$getnum.val()?this.$getnum.val(999):isNaN(+this.$getnum.val())&&this.$getnum.val(1)},u.prototype.addcart=function(){var t=this;if(this.getcookie("cookieid")){var i=this.getcookie("cookieid").split(","),s=this.getcookie("cookienum").split(","),o=this.getcookie("cookietable").split(",");if(-1!=i.indexOf(n.id)){var e=i.indexOf(n.id);s.splice(e,1,Number(s[e])+Number(this.$getnum.val())),this.setcookie("cookienum",String(s),7),new Modal({btnname:".add-btn",modalsheet:!0,modalname:".titlebox1-success",modalresize:!1,drag:!1,starttop:300}),this.timer=setTimeout(function(){t.$titlebox1.css("display","none"),clearTimeout(t.timer)},500)}else i.push(n.id),s.push(this.$getnum.val()),o.push(n.table),this.setcookie("cookieid",String(i),7),this.setcookie("cookienum",String(s),7),this.setcookie("cookietable",String(o),7),new Modal({btnname:".add-btn",modalsheet:!0,modalname:".titlebox1-success",modalresize:!1,drag:!1,starttop:300}),this.timer=setTimeout(function(){t.$titlebox1.css("display","none"),clearTimeout(t.timer)},500)}else this.idarr.push(n.id),this.numarr.push(this.$getnum.val()),this.tablearr.push(n.table),this.setcookie("cookieid",String(this.idarr),7),this.setcookie("cookienum",String(this.numarr),7),this.setcookie("cookietable",String(this.tablearr),7),new Modal({btnname:".add-btn",modalsheet:!0,modalname:".titlebox1-success",modalresize:!1,drag:!1,starttop:300}),this.timer=setTimeout(function(){t.$titlebox1.css("display","none"),clearTimeout(t.timer)},500)},u.prototype.setcookie=function(t,i,s){var o=new Date;o.setDate(o.getDate()+s),document.cookie=t+"="+i+";expires="+o},u.prototype.getcookie=function(t){for(var i=document.cookie.split("; "),s=0;s<i.length;s++){var o=i[s].split("=");if(o[0]===t)return o[1]}},new u,new Modal({btnname:".add-btn",modalsheet:!0,modalname:".titlebox1-success",modalresize:!1,drag:!1,starttop:300})})},t.prototype.setcookie=function(t,i,s){var o=new Date;o.setDate(o.getDate()+s),document.cookie=t+"="+i+";expires="+o},t.prototype.getcookie=function(t){for(var i=document.cookie.split("; "),s=0;s<i.length;s++){var o=i[s].split("=");if(o[0]===t)return o[1]}},t.prototype.removecookie=function(t){this.setcookie(t,"",-1)},new t}(jQuery);